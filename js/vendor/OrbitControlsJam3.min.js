function createOrbitControls(t){function e(){var t=p.up||Y_UP;quatFromVec3(o,t,Y_UP),quatInvert(r,o);var e=p.distance;glVec3.subtract(a,p.position,p.target),glVec3.transformQuat(a,a,o);var n=Math.atan2(a[0],a[2]),u=Math.atan2(Math.sqrt(a[0]*a[0]+a[2]*a[2]),a[1]);n+=i[0],u+=i[1],n=clamp(n,p.thetaBounds[0],p.thetaBounds[1]),u=clamp(u,p.phiBounds[0],p.phiBounds[1]),u=clamp(u,EPSILON,Math.PI-EPSILON),e+=i[2],e=clamp(e,p.distanceBounds[0],p.distanceBounds[1]);var d=Math.abs(e)<=EPSILON?EPSILON:e;a[0]=d*Math.sin(u)*Math.sin(n),a[1]=d*Math.cos(u),a[2]=d*Math.sin(u)*Math.cos(n),c=u,s=n,p.distance=e,glVec3.transformQuat(a,a,r),glVec3.add(p.position,p.target,a),camLookAt(p.direction,t,p.position,p.target)}function n(){var t=p.phi,n=p.theta;n=clamp(n,p.thetaBounds[0],p.thetaBounds[1]),t=clamp(t,p.phiBounds[0],p.phiBounds[1]),t=clamp(t,EPSILON,Math.PI-EPSILON);var i=Math.max(EPSILON,p.distance);p.position[0]=i*Math.sin(t)*Math.sin(n),p.position[1]=i*Math.cos(t),p.position[2]=i*Math.sin(t)*Math.cos(n),glVec3.add(p.position,p.position,p.target),e()}t=t||{};var i=[0,0,0],a=[0,0,0],o=[0,0,0,1],r=o.slice(),c=defined(t.phi,Math.PI/2),s=t.theta||0,p={update:function(){e();for(var t="number"==typeof p.damping?p.damping:1,n=0;n<i.length;n++)i[n]*=1-t},copyInto:function(t,e,n){t&&glVec3.copy(t,p.position),e&&glVec3.copy(e,p.direction),n&&glVec3.copy(n,p.up)},position:t.position?t.position.slice():[0,0,1],direction:[0,0,-1],up:t.up?t.up.slice():[0,1,0],target:t.target?t.target.slice():[0,0,0],distance:defined(t.distance,1),damping:defined(t.damping,.25),rotateSpeed:defined(t.rotateSpeed,.28),zoomSpeed:defined(t.zoomSpeed,.0075),pinchSpeed:defined(t.pinchSpeed,.0075),pinch:!1!==t.pinching,zoom:!1!==t.zoom,rotate:!1!==t.rotate,phiBounds:t.phiBounds||[0,Math.PI],thetaBounds:t.thetaBounds||[-1/0,1/0],distanceBounds:t.distanceBounds||[0,1/0]};"number"!=typeof t.distance&&(glVec3.subtract(tmpVec3,p.position,p.target),p.distance=glVec3.length(tmpVec3));var u=inputEvents({parent:t.parent||window,element:t.element,rotate:!1!==t.rotate?function(t,e){var n=2*Math.PI;i[0]-=n*t*p.rotateSpeed,i[1]-=n*e*p.rotateSpeed}:null,zoom:!1!==t.zoom?function(t){i[2]+=t*p.zoomSpeed}:null,pinch:!1!==t.pinch?function(t){i[2]-=t*p.pinchSpeed}:null});return p.enable=u.enable,p.disable=u.disable,Object.defineProperties(p,{phi:{get:function(){return c},set:function(t){c=t,n()}},theta:{get:function(){return s},set:function(t){s=t,n()}},dragging:{get:function(){return u.isDragging()}},pinching:{get:function(){return u.isPinching()}}}),n(),p}function camLookAt(t,e,n,i){glVec3.copy(t,i),glVec3.subtract(t,t,n),glVec3.normalize(t,t)}var defined=require("defined"),clamp=require("clamp"),inputEvents=require("./lib/input"),quatFromVec3=require("quat-from-unit-vec3"),quatInvert=require("gl-quat/invert"),glVec3={length:require("gl-vec3/length"),add:require("gl-vec3/add"),subtract:require("gl-vec3/subtract"),transformQuat:require("gl-vec3/transformQuat"),copy:require("gl-vec3/copy"),normalize:require("gl-vec3/normalize"),cross:require("gl-vec3/cross")},Y_UP=[0,1,0],EPSILON=Math.pow(2,-23),tmpVec3=[0,0,0];module.exports=createOrbitControls;